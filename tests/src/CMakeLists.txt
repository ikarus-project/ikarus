option(ENABLE_TEST_COVERAGE "Enable test coverage" OFF)
set(IWYU_ARGS "-Xiwyu --mapping_file=iwyu.imp")
include(../../cmake/tools.cmake)
find_package(Eigen3 3.3.9 REQUIRED)
find_package(spdlog REQUIRED)
find_package(autodiff REQUIRED)
find_package(Matplot++ REQUIRED)
include_directories(../../libAddons/eigen/eigenAddons)
file(GLOB programSourceFiles CONFIGURE_DEPENDS *.cpp)
foreach(programSourceFile ${programSourceFiles})
    get_filename_component(programName ${programSourceFile} NAME_WLE)
    dune_add_test(SOURCES ${programSourceFile} LINK_LIBRARIES Ikarus::ikarus)
    target_compile_features(${programName} PUBLIC cxx_std_20)
      if(ENABLE_TEST_COVERAGE)
        message("Enable Test Coverage")
        target_compile_options(${programName} PUBLIC -O1 -fprofile-arcs -ftest-coverage -fPIC)
        target_link_options(${programName} PUBLIC -fprofile-arcs -ftest-coverage)
      endif()
endforeach()

